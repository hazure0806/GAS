## 【開発者向け】お客様環境への手動セットアップ手順書

### **前提条件**

- お客様のGoogleアカウントにログインしていること。
- 事前にGoogleドライブのフォルダ作成と、スプレッドシートの配置が完了していること。
- 手元に完成版のプロジェクトファイル（`src/main.js`と`appsscript.json`）が準備できていること。

---

### **Step 1: Apps Script エディタを開く**

1.  お客様の環境に配置した**`領収書送付管理シート`**を開きます。
2.  上部メニューの **`[拡張機能] > [Apps Script]`** をクリックします。
    - これにより、このスプレッドシートに紐づいたGASエディタが新しいタブで開きます。

### **Step 2: スクリプトファイルを作成・編集する**

1.  **デフォルトファイルの削除**:

    - エディタの左側「ファイル」セクションに、デフォルトで`コード.js`というファイルがあります。このファイルの右側にある︙（縦三点リーダー）をクリックし、**[削除]** を選択して削除します。

2.  **新しいスクリプトファイルの作成**:

    - 「ファイル」の横にある `+` アイコンをクリックし、**[スクリプト]** を選択します。
    - ファイル名を聞かれるので、`main` と入力してEnterキーを押します。（`main.js`が作成されます）

3.  **コードの貼り付け**:
    - 手元にある完成版の **`src/main.js`** の中身をすべてコピーします。
    - GASエディタで開いている `main.js` の中に、コピーしたコードをすべて貼り付けます。

### **Step 3: マニフェストファイルを編集する**

1.  GASエディタの左側メニューから **[プロジェクトの設定]** (歯車⚙️アイコン) をクリックします。
2.  **「appsscript.json」マニフェスト ファイルをエディタで表示する** というチェックボックスに**チェックを入れます。**
3.  左側の「ファイル」セクションに戻ると、`appsscript.json` というファイルが表示されていますので、これをクリックして開きます。
4.  手元にある完成版の **`appsscript.json`** の中身をすべてコピーし、エディタに表示されている内容に上書きする形で貼り付けます。

### **Step 4: 【最重要】スクリプトプロパティを設定する**

1.  再度、**[プロジェクトの設定]** (歯車⚙️アイコン) をクリックします。
2.  画面を下にスクロールし、**[スクリプト プロパティ]** のセクションを見つけます。
3.  **[スクリプト プロパティを編集]** ボタンをクリックします。
4.  以下の通り、キーと値を正確に入力し、**[スクリプト プロパティを保存]** をクリックします。
    - **プロパティ (キー):** `PDF_PARENT_FOLDER_ID`
    - **値:** お客様の環境で作成した **`領収書PDF` フォルダのID**

### **Step 5: 保存と最終確認**

1.  エディタ上部にある**フロッピーディスクのアイコン（プロジェクトを保存）**をクリックして、すべての変更を保存します。
2.  **スプレッドシートのタブに戻り、ブラウザを再読み込み**してください。
3.  上部メニューに `[領収書メール作成]` が表示されれば、すべての設定は成功です。

最後に、メニューから一度スクリプトを実行し、お客様のアカウントで初回承認を行えば、すべてのセットアップが完了となります。
